<!DOCTYPE html>
<html lang="pt-br">

<head>
  <link rel="shortcut icon" href="../assets/icon/logo-branca.ico" type="image/x-icon">
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SolarData | Suporte</title>

  <link rel="stylesheet" href="./../css/suporte.css">
  <link rel="stylesheet" href="./../css/cabecalho3.css">


  <script src="../js/sessao.js"></script>
  <script src="./../js/alerta.js"></script>

  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link
    href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
    rel="stylesheet">

  <!-- FONT AWESOME -->
  <script src="https://kit.fontawesome.com/9f7414eb10.js" crossorigin="anonymous"></script>
</head>

<body>
  <!-- Cabeçalho -->
  <div class="total-dash">
    <div class="dashboard-bg">
      <div class="dashboard-sidebar">
        <div class="dashboard-logo"></div>
        <div class="dashboard-sidebar-btns">
          <a href="alertas.html" class="dashboard-sidebar-btn">
            <div class="icon-alert"></div>
            <h3>Alertas</h3>
          </a>
          <a href="conta.html" class="dashboard-sidebar-btn">
            <div class="icon-user"></div>
            <h3>Conta</h3>
          </a>
          <a href="dashboard-alto.html" class="dashboard-sidebar-btn">
            <div class="icon-dashboard"></div>
            <h3>Painel de <br> Controle</h3>
          </a>
          <!--
                    <a href="relatorios.html" class="dashboard-sidebar-btn">
                        <div class="icon-relatory"></div>
                        <h3>Relatórios</h3>
                    </a>
                  -->
          <a href="suporte.html" class="dashboard-sidebar-btn">
            <div class="icon-support"></div>
            <h3>Suporte</h3>
          </a>
        </div>
        <a href="/public/index.html" class="dashboard-logout">
          <div class="icon-logout"></div>
          <h3>Logout</h3>
        </a>
      </div>
      <!-- Cabeçalho topo -->
      <div class="dashboard-low-right-side">
        <div class="dashboard-topbar">
          <a href="#" class="btn-voltar">
            Suporte - SolarData
          </a>
          <div class="btns-topbar">
            <!-- <a id="btnCadsatrarMaquina" href="cadastrar-maquina.html" class="btn-cadastrar-maquina">
                        Cadastrar Máquina
                    </a> -->
            <!-- <a href="relatorios.html" class="btn-gerar-relatorio">
                        Gerar relatorio
                    </a> -->
            <div class="btn-padrao">
              <button class="btn-notificacao">
              </button>
              <a href="conta.html" class="btn-conta">
              </a>
            </div>
          </div>
        </div>

        <!-- Fim Cabeçalho -->
        <div class="faq-container">

          <div class="faq-header">
            <h2>Perguntas Frequentes (FAQ)</h2>
            <p>Veja se a sua dúvida já foi respondida.</p>
          </div>

          <div class="faq-item">
            <div class="faq-question">
              <span>Como entro em contato com o suporte?</span>
              <span class="faq-icon">+</span>
            </div>
            <div class="faq-answer">
              <p>Você pode entrar em contato com a nossa equipe pelo chat disponível na página inicial, ou enviando um
                email para <b>techsolardata@gmail.com</b></p>
            </div>
          </div>

          <div class="faq-item">
            <div class="faq-question">
              <span>Como faço alteração de cadastro?</span>
              <span class="faq-icon">+</span>
            </div>
            <div class="faq-answer">
              <p>Após o login realizado, vá até a aba <b>Contas</b>, e clique em <b>Alterar cadastro</b>. Neste menu,
                você consegue alterar seu email, senha e foto de perfil.</p>
            </div>
          </div>

          <div class="faq-item">
            <div class="faq-question">
              <span>Esqueci minha senha, o que faço?</span>
              <span class="faq-icon">+</span>
            </div>
            <div class="faq-answer">
              <p>Clique em <b>Esqueci minha senha</b> na tela de login, e siga as instruções para redefinir. Um link
                será enviado para o email cadastrado.</p>
            </div>
          </div>

          <div class="faq-item">
            <div class="faq-question">
              <span>Como funciona a geração de relatórios?</span>
              <span class="faq-icon">+</span>
            </div>
            <div class="faq-answer">
              <p>Após clicar no botão <b>Gerar relatório</b> na tela do <b>Painel de controle</b>, será gerado um
                arquivo com extensão PDF, com as informações capturadas baseado na análise daquele momento. Os
                relatórios são gerados com IA.</p>
            </div>
          </div>

          <div class="faq-item">
            <div class="faq-question">
              <span>De que forma sou notificado(a) sobre o monitoramento?</span>
              <span class="faq-icon">+</span>
            </div>
            <div class="faq-answer">
              <p>É combinado com nossos clientes as métricas de preferência em sua empresa. Nós utilizamos a poderosa
                ferramenta <b>Slack</b>. Com ela, assim que a métrica definida for ultrapassada ou reduzida com a
                medição do monitamento do componente, é enviado uma notificação para a equipe responsável.</p>
            </div>
          </div>

          <div class="faq-footer">
            <p>Ainda não conseguiu tirar sua dúvida ou resolver seu problema?</p>
            <button class="btn-chamado" onclick="abrirChamado()">Abrir chamado</button>
          </div>

        </div>

      </div>
    </div>
    <div id="lista-maquinas"></div>

    <div id="modalNotificacoes">
      <div class="modal-content">
        <div id="alertasContainer"></div>
        <button id="btnFecharModal">Fechar</button>

      </div>


</body>

</html>
<script>

  let perguntas = document.querySelectorAll('.faq-question');

  for (let i = 0; i < perguntas.length; i++) {
    perguntas[i].onclick = function () {
      this.parentElement.classList.toggle('active');
    }
  }

  function abrirChamado() {
    window.open('https://solardata.atlassian.net/jira/servicedesk/projects/SS/queues/custom/1?cloudId=66c16323-0eec-43be-9767-f36a00f186fb&atlOrigin=eyJpIjoiYTA2ZmVlOGZjOTk2NDc5NGI1YmFjMzNjOWM3ZTg2YTQiLCJwIjoiaiJ9', '_blank');
  }






  document.addEventListener("DOMContentLoaded", () => {

    const btnNotificacao = document.querySelector('.btn-notificacao');
    const modal = document.getElementById('modalNotificacoes');
    const btnFecharModal = document.getElementById('btnFecharModal');
    const alertasContainer = document.getElementById('alertasContainer');
    const listaMaquinas = document.getElementById('lista-maquinas');

    if (!btnNotificacao || !modal || !btnFecharModal || !alertasContainer || !listaMaquinas) {
      console.error("Elementos de alerta/maquinas não encontrados:", {
        btnNotificacao, modal, btnFecharModal, alertasContainer, listaMaquinas
      });
      return;
    }

    const alertasMock = [
      { identificador: "Server-SP01", componenteNome: "CPU", captura: 87.5, estado: "ALERTA CRITICO", dtHora: "2025-10-28T21:05:17" },
      { identificador: "Server-SP02", componenteNome: "RAM", captura: 82.1, estado: "ALERTA PREVENTIVO", dtHora: "2025-10-28T21:03:12" },
      { identificador: "Server-SP03", componenteNome: "DISCO", captura: 91.3, estado: "ALERTA CRITICO", dtHora: "2025-10-28T21:01:45" },
      { identificador: "Server-SP01", componenteNome: "CPU", captura: 68.9, estado: "ALERTA PREVENTIVO", dtHora: "2025-10-28T21:00:32" }
    ];

    const maquinasMock = [
      { HostName: "server-sp01", Identificador: "Server-SP01", IP: "192.168.0.10", DataCriacao: "2025-10-20T10:00:00", UltimoAlerta: "2025-10-28T21:05:17", CPU: 75, RAM: 82 },
      { HostName: "server-sp02", Identificador: "Server-SP02", IP: "192.168.0.11", DataCriacao: "2025-10-22T14:32:00", UltimoAlerta: "2025-10-28T21:03:12", CPU: 45, RAM: 70 },
      { HostName: "server-sp03", Identificador: "Server-SP03", IP: "192.168.0.12", DataCriacao: "2025-10-18T09:21:00", UltimoAlerta: "2025-10-28T21:01:45", CPU: 91, RAM: 76 },
      { HostName: "server-rj01", Identificador: "Server-RJ01", IP: "192.168.1.10", DataCriacao: "2025-10-15T08:00:00", UltimoAlerta: "2025-10-27T19:45:00", CPU: 20, RAM: 25 }
    ];

    function formatarData(iso) {
      if (!iso) return "—";
      const d = new Date(iso);
      if (isNaN(d)) return "—";
      return d.toLocaleString("pt-BR", { day: "2-digit", month: "2-digit", year: "numeric", hour: "2-digit", minute: "2-digit" });
    }

    function carregarAlertas() {
      alertasContainer.innerHTML = "";
      if (!alertasMock.length) {
        alertasContainer.innerHTML = "<p class='text-muted text-center'>Nenhum alerta.</p>";
        return;
      }
      alertasMock.forEach(a => {
        const tipoClasse = a.estado == "ALERTA CRITICO" ? "danger" : a.estado == "ALERTA PREVENTIVO" ? "warning" : "success";
        const div = document.createElement("div");
        div.className = `alerta-item ${tipoClasse}`;
        div.innerHTML = `
        <strong>${a.identificador}</strong>
        <small style="display:block;margin-top:4px;">${a.componenteNome} • <b>${a.captura}%</b></small>
        <div style="margin-top:6px;"><small>Estado: <b>${a.estado}</b></small></div>
        <small style="display:block;margin-top:6px;color:#555">${formatarData(a.dtHora)}</small>
      `;
        alertasContainer.appendChild(div);
      });
    }

    function carregarMaquinas() {
      listaMaquinas.innerHTML = "";
      maquinasMock.forEach(m => {
        const usoCPU = `${m.CPU}%`, usoRAM = `${m.RAM}%`;
        let estado = "normal";
        if (m.CPU > 80 || m.RAM > 90) estado = "alerta critico";
        else if (m.CPU >= 70 || m.RAM >= 80) estado = "alerta preventivo";
        else if (m.CPU < 10 && m.RAM < 10) estado = "ocioso";

        const linha = document.createElement("div");
        linha.className = "line-notifica";
        linha.innerHTML = `
        <div class="box-id"><p>${m.HostName}</p></div>
        <div class="box-nome"><p>${m.Identificador}</p></div>
        <div class="box-uptime"><p>${m.IP}</p></div>
        <div class="box-uptime"><p>${formatarData(m.DataCriacao)}</p></div>
        <div class="box-ocorrencia"><p>${formatarData(m.UltimoAlerta)}</p></div>
        <div class="box-rack"><p>${usoCPU}</p></div>
        <div class="box-rack"><p>${usoRAM}</p></div>
        <div class="box-status"><p class="status ${estado}">${estado.toUpperCase()}</p></div>
      `;

        linha.addEventListener("click", () => {
          window.location.href = `dashboard.html?id=${encodeURIComponent(m.Identificador)}`;
        });

        listaMaquinas.appendChild(linha);
      });
    }

    btnNotificacao.addEventListener("click", () => {
      console.log("Clicou no botão de notificação");
      modal.classList.add("active");
      carregarAlertas();
    });
    btnFecharModal.addEventListener("click", () => modal.classList.remove("active"));
    modal.addEventListener("click", (e) => { if (e.target === modal) modal.classList.remove("active"); });

    carregarMaquinas();
    console.log("carregarMaquinas() executado — máquinas mockadas exibidas.");
  });







</script>