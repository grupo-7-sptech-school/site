<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>SolarData | Login</title>

    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
      integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO"
      crossorigin="anonymous"
    />
    <script src="./js/sessao.js"></script>
    <link rel="icon" href="./assets/icon/logoSD.png" />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="./css/login.css" />
  </head>

  <body>
    <div class="container-fluid login-container">
      <div class="row h-100 justify-content-center align-items-center">
        <div
          class="col-12 col-sm-10 col-md-9 col-lg-8 rounded-3 d-flex p-0"
          style="max-height: 550px"
        >
          <div class="col-md-6 image-col rounded-start-3"></div>

          <div
            class="col-12 col-md-6 form-col bg-white rounded-end-3 rounded-start-3 rounded-md-start-0"
          >
            <div class="mb-4">
              <a href="#" class="text-decoration-none text-dark">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="24"
                  height="24"
                  fill="currentColor"
                  class="bi bi-arrow-left"
                  viewBox="0 0 16 16"
                >
                  <path
                    fill-rule="evenodd"
                    d="M15 8a.5.5 0 0 0-.5-.5H2.707l3.147-3.146a.5.5 0 1 0-.708-.708l-4 4a.5.5 0 0 0 0 .708l4 4a.5.5 0 0 0 .708-.708L2.707 8.5H14.5a.5.5 0 0 0 .5-.5z"
                  />
                </svg>
              </a>
            </div>

            <h2 class="login-title" style="color: #0b795b">Login</h2>

            <form onsubmit="return entrar();">
              <div class="input-group-custom">
                <label for="inputEmail" class="form-label"><b>Email</b></label>
                <div class="input-icon-wrapper">
                  <span class="input-icon-left">
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="20"
                      height="20"
                      fill="#18B187"
                      viewBox="0 0 16 16"
                    >
                      <path
                        d="M0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V4zm2-1a1 1 0 0 0-1 1v.217l7 4.2 7-4.2V4a1 1 0 0 0-1-1H2zm13 2.383-4.708 2.825L15 11.383V5.383zm-.034 7.434-5.966-3.583-5.966 3.583A1 1 0 0 0 2 13h12a1 1 0 0 0 .966-.183zM1 11.383l4.708-3.175L1 5.383v6z"
                      />
                    </svg>
                  </span>
                  <input
                    type="email"
                    class="input-custom"
                    id="email_input"
                    placeholder="Insira seu endereço de email"
                  />
                </div>
              </div>

              <div class="input-group-custom">
                <label for="inputPassword" class="form-label"><b>Senha</b></label>
                <div class="input-icon-wrapper">
                  <span class="input-icon-left">
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="20"
                      height="20"
                      fill="#18B187"
                      viewBox="0 0 16 16"
                    >
                      <path
                        d="M8 1a4 4 0 0 0-4 4v2a2 2 0 0 0-2 2v5a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2v-5a2 2 0 0 0-2-2V5a4 4 0 0 0-4-4zm-3 4a3 3 0 0 1 6 0v2H5V5zm-2 4a1 1 0 0 1 1-1h8a1 1 0 0 1 1 1v5a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V9zm5 3a1 1 0 1 1-2 0 1 1 0 0 1 2 0z"
                      />
                    </svg>
                  </span>
                  <input
                    type="password"
                    class="input-custom"
                    id="inputPassword"
                    placeholder="Insira sua senha"
                  />
                  <span class="input-icon-right" onclick="togglePassword()">
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="20"
                      height="20"
                      fill="#18B187"
                      viewBox="0 0 16 16"
                    >
                      <path
                        d="M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8zm-8 4a4 4 0 1 1 0-8 4 4 0 0 1 0 8zm0-1.5a2.5 2.5 0 1 0 0-5 2.5 2.5 0 0 0 0 5z"
                      />
                    </svg>
                  </span>
                </div>
              </div>

              <div
                class="d-flex justify-content-between align-items-center mb-4 small"
              >
                <div class="form-check">
                  <input
                    class="form-check-input"
                    type="checkbox"
                    value=""
                    id="checkRemember"
                  />
                  <label
                    class="form-check-label text-muted"
                    for="checkRemember"
                  >
                    Lembrar de mim
                  </label>
                </div>
                <div>
                  <a href="#" class="text-muted text-decoration-none"
                    >Esqueceu sua senha?</a
                  >
                </div>
              </div>

              <button type="submit" class="btn btn-green w-100 py-2 fw-bold">
                Login
              </button>

              <p class="mt-4 text-center">
                Ainda não tem uma conta?
                <b
                  href="#"
                  class="text-green text-decoration-none fw-bold"
                  style="color: #18b187"
                  >Registre-se aqui!</b
                >
              </p>
            </form>
          </div>
        </div>
      </div>
    </div>

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
      crossorigin="anonymous"
    ></script>
    <script>
      function togglePassword() {
        const input = document.getElementById("inputPassword");
        input.type = input.type === "password" ? "text" : "password";
      }
    </script>
    <script>
      function entrar() {
        aguardar();

        var emailVar = email_input.value;
        var senhaVar = inputPassword.value;

        if (emailVar == "" || senhaVar == "") {
          cardErro.style.display = "block";
          mensagem_erro.innerHTML =
            "(Mensagem de erro para todos os campos em branco)";
          finalizarAguardar();
          return false;
        } else {
          setInterval(sumirMensagem, 5000);
        }

        fetch("/usuarios/autenticar", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify({
            emailServer: emailVar,
            senhaServer: senhaVar,
          }),
        })
          .then(function (resposta) {
            if (resposta.ok) {
              resposta.json().then((json) => {
                sessionStorage.EMAIL_USUARIO = json.email;
                sessionStorage.NOME_USUARIO = json.nome;
                sessionStorage.ID_USUARIO = json.idusuario;
                setTimeout(function () {
                  window.location = "./dashboard/cards.html";
                }, 1000);
              });
            } else {
              resposta.text().then((texto) => {
                finalizarAguardar(texto);
              });
            }
          })
          .catch(function (erro) {
            console.log(erro);
          });

        return false;
      }

      function sumirMensagem() {
        cardErro.style.display = "none";
      }
    </script>
  </body>
</html>
